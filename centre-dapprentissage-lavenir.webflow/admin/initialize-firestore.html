<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Initialiser Firestore</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #f5f5f5;
      padding: 40px 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    .container {
      max-width: 700px;
      background: white;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    h1 {
      color: #333;
      margin-bottom: 20px;
      text-align: center;
    }

    .info {
      background: #e3f2fd;
      color: #1565c0;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      line-height: 1.6;
    }

    .warning {
      background: #fff3cd;
      color: #856404;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      line-height: 1.6;
    }

    .btn {
      background: #007bff;
      color: white;
      padding: 15px 30px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      width: 100%;
      transition: background 0.3s;
      margin-top: 20px;
    }

    .btn:hover {
      background: #0056b3;
    }

    .btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .success {
      background: #d4edda;
      color: #155724;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
      display: none;
    }

    .error {
      background: #f8d7da;
      color: #721c24;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
      display: none;
    }

    .collections {
      margin: 20px 0;
    }

    .collection-item {
      padding: 15px;
      background: #f8f9fa;
      border-left: 4px solid #007bff;
      margin: 10px 0;
      border-radius: 4px;
    }

    .collection-item h3 {
      color: #007bff;
      margin-bottom: 8px;
      font-size: 18px;
    }

    .collection-item p {
      color: #666;
      font-size: 14px;
      margin: 4px 0;
    }

    .progress {
      margin-top: 20px;
      display: none;
    }

    .progress-item {
      padding: 10px;
      background: #f8f9fa;
      margin: 5px 0;
      border-radius: 4px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .progress-item.success {
      background: #d4edda;
      color: #155724;
      display: flex;
    }

    .progress-item.error {
      background: #f8d7da;
      color: #721c24;
      display: flex;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üöÄ Initialiser Firestore</h1>

    <div class="info">
      <strong>üìù Ce script va cr√©er:</strong>
      <ul style="margin-top: 10px; margin-left: 20px;">
        <li>Collection <strong>bannerMessages</strong> avec un message d'exemple</li>
        <li>Collection <strong>blogArticles</strong> avec 3 articles d'exemple</li>
        <li>Collection <strong>resources</strong> avec 4 ressources d'exemple</li>
      </ul>
    </div>

    <div class="warning">
      <strong>‚ö†Ô∏è Attention:</strong> Ex√©cutez ce script une seule fois pour initialiser vos collections. Si vous l'ex√©cutez plusieurs fois, des documents seront ajout√©s √† chaque fois.
    </div>

    <div class="collections">
      <h2 style="margin-bottom: 15px;">Collections qui seront cr√©√©es:</h2>
      
      <div class="collection-item">
        <h3>üì¢ bannerMessages</h3>
        <p>1 banni√®re d'exemple avec message court et popup</p>
      </div>

      <div class="collection-item">
        <h3>üì∞ blogArticles</h3>
        <p>3 articles de blog d'exemple</p>
      </div>

      <div class="collection-item">
        <h3>üìö resources</h3>
        <p>2 ressources pour √©l√®ves + 2 ressources pour parents</p>
      </div>
    </div>

    <button id="initBtn" class="btn" onclick="initializeFirestore()">
      Initialiser Firestore
    </button>

    <div id="progress" class="progress"></div>
    <div id="success" class="success"></div>
    <div id="error" class="error"></div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <!-- Firebase Configuration -->
  <script src="../js/firebase-config.js"></script>

  <script>
    async function initializeFirestore() {
      const btn = document.getElementById('initBtn');
      const progressDiv = document.getElementById('progress');
      const successDiv = document.getElementById('success');
      const errorDiv = document.getElementById('error');

      btn.disabled = true;
      btn.textContent = 'Initialisation en cours...';
      progressDiv.style.display = 'block';
      progressDiv.innerHTML = '';
      successDiv.style.display = 'none';
      errorDiv.style.display = 'none';

      function addProgress(message, status = 'pending') {
        const item = document.createElement('div');
        item.className = `progress-item ${status}`;
        item.textContent = status === 'success' ? '‚úÖ ' + message : status === 'error' ? '‚ùå ' + message : '‚è≥ ' + message;
        progressDiv.appendChild(item);
        return item;
      }

      try {
        // 1. Create Banner Message
        let progress = addProgress('Cr√©ation de la banni√®re...');
        const bannerData = {
          shortMessage: "üéâ Bienvenue au Centre d'Apprentissage L'Avenir - Inscriptions ouvertes!",
          fullTitle: "Inscriptions ouvertes pour la session d'automne 2025",
          fullText: `
            <p>Nous sommes ravis d'annoncer que les inscriptions pour la session d'automne 2025 sont maintenant ouvertes!</p>
            
            <p><strong>Nos services incluent:</strong></p>
            <ul>
              <li>Aide aux devoirs personnalis√©e</li>
              <li>Rattrapage scolaire</li>
              <li>Pr√©paration aux examens</li>
              <li>Enrichissement acad√©mique</li>
            </ul>
            
            <p>Pour plus d'informations ou pour r√©server votre place, <a href="/contact.html">contactez-nous</a> d√®s aujourd'hui!</p>
            
            <p><em>Places limit√©es - R√©servez vite!</em></p>
          `,
          image: "",
          type: "success",
          active: true,
          updatedAt: firebase.firestore.Timestamp.now()
        };
        
        await db.collection('bannerMessages').doc('current').set(bannerData);
        progress.className = 'progress-item success';
        progress.textContent = '‚úÖ Banni√®re cr√©√©e avec succ√®s';

        // 2. Create Blog Articles
        progress = addProgress('Cr√©ation des articles de blog...');
        const blogArticles = [
          {
            title: "5 Conseils pour R√©ussir les Devoirs",
            slug: "5-conseils-reussir-devoirs",
            excerpt: "D√©couvrez nos meilleurs conseils pour aider votre enfant √† r√©ussir ses devoirs et am√©liorer sa performance scolaire.",
            content: `
              <p>Les devoirs peuvent parfois √™tre un d√©fi pour les enfants et les parents. Voici nos 5 meilleurs conseils pour faciliter ce moment.</p>
              
              <h3>1. Cr√©er un espace de travail d√©di√©</h3>
              <p>Un environnement calme et organis√© favorise la concentration.</p>
              
              <h3>2. √âtablir une routine</h3>
              <p>Une heure fixe pour les devoirs aide √† cr√©er de bonnes habitudes.</p>
              
              <h3>3. Faire des pauses r√©guli√®res</h3>
              <p>Des pauses de 5-10 minutes toutes les 30 minutes am√©liorent la productivit√©.</p>
              
              <h3>4. Encourager l'autonomie</h3>
              <p>Laissez votre enfant essayer d'abord par lui-m√™me avant d'intervenir.</p>
              
              <h3>5. C√©l√©brer les r√©ussites</h3>
              <p>Reconna√Ætre les efforts et les progr√®s motive l'enfant.</p>
            `,
            author: "L'√©quipe du Centre",
            category: "Conseils",
            featuredImage: "",
            published: true,
            publishDate: firebase.firestore.Timestamp.now(),
            createdAt: firebase.firestore.Timestamp.now(),
            updatedAt: firebase.firestore.Timestamp.now()
          },
          {
            title: "Comment Pr√©parer Votre Enfant aux Examens",
            slug: "preparer-enfant-examens",
            excerpt: "Une pr√©paration efficace aux examens commence bien avant la date de l'examen. D√©couvrez nos strat√©gies.",
            content: `
              <p>La pr√©paration aux examens est cruciale pour la r√©ussite scolaire. Voici comment bien s'y prendre.</p>
              
              <h3>Planification</h3>
              <p>Commencez √† r√©viser au moins 2 semaines avant l'examen.</p>
              
              <h3>Techniques de m√©morisation</h3>
              <ul>
                <li>Fiches de r√©vision</li>
                <li>Cartes m√©moire</li>
                <li>Explications √† voix haute</li>
                <li>Exercices pratiques</li>
              </ul>
              
              <h3>Gestion du stress</h3>
              <p>Enseignez des techniques de respiration et d'organisation pour r√©duire l'anxi√©t√©.</p>
            `,
            author: "Marie Tremblay, tutrice",
            category: "Examens",
            featuredImage: "",
            published: true,
            publishDate: firebase.firestore.Timestamp.now(),
            createdAt: firebase.firestore.Timestamp.now(),
            updatedAt: firebase.firestore.Timestamp.now()
          },
          {
            title: "L'Importance du Soutien Scolaire",
            slug: "importance-soutien-scolaire",
            excerpt: "Le soutien scolaire peut faire toute la diff√©rence dans le parcours acad√©mique d'un enfant.",
            content: `
              <p>Le soutien scolaire ne se limite pas √† l'aide aux devoirs. C'est un accompagnement complet qui renforce la confiance et les comp√©tences.</p>
              
              <h3>B√©n√©fices du soutien scolaire</h3>
              <ul>
                <li>Meilleure compr√©hension des mati√®res</li>
                <li>D√©veloppement de l'autonomie</li>
                <li>Renforcement de la confiance en soi</li>
                <li>Am√©lioration des r√©sultats</li>
              </ul>
              
              <h3>Notre approche</h3>
              <p>Au Centre d'Apprentissage L'Avenir, nous adaptons nos m√©thodes √† chaque √©l√®ve pour garantir sa r√©ussite.</p>
            `,
            author: "Jean Lefebvre, directeur",
            category: "Nouvelles",
            featuredImage: "",
            published: true,
            publishDate: firebase.firestore.Timestamp.now(),
            createdAt: firebase.firestore.Timestamp.now(),
            updatedAt: firebase.firestore.Timestamp.now()
          }
        ];

        for (const article of blogArticles) {
          await db.collection('blogArticles').add(article);
        }
        progress.className = 'progress-item success';
        progress.textContent = `‚úÖ ${blogArticles.length} articles cr√©√©s avec succ√®s`;

        // 3. Create Resources
        progress = addProgress('Cr√©ation des ressources...');
        const resources = [
          {
            title: "Guide de Math√©matiques - Primaire",
            description: "Guide complet couvrant les concepts math√©matiques du primaire avec exercices pratiques",
            category: "students",
            type: "pdf",
            fileUrl: "#",
            thumbnailUrl: "",
            subject: "math√©matiques",
            gradeLevel: ["primaire-1-3", "primaire-4-6"],
            published: true,
            createdAt: firebase.firestore.Timestamp.now()
          },
          {
            title: "Fiches de R√©vision - Fran√ßais",
            description: "Fiches pratiques pour r√©viser la grammaire, l'orthographe et la conjugaison",
            category: "students",
            type: "pdf",
            fileUrl: "#",
            thumbnailUrl: "",
            subject: "fran√ßais",
            gradeLevel: ["primaire-4-6", "secondaire"],
            published: true,
            createdAt: firebase.firestore.Timestamp.now()
          },
          {
            title: "Guide pour Parents - Comment Aider aux Devoirs",
            description: "Conseils pratiques pour accompagner efficacement votre enfant dans ses devoirs",
            category: "parents",
            type: "pdf",
            fileUrl: "#",
            thumbnailUrl: "",
            subject: "g√©n√©ral",
            gradeLevel: ["tous"],
            published: true,
            createdAt: firebase.firestore.Timestamp.now()
          },
          {
            title: "Calendrier de R√©vision",
            description: "Mod√®le de calendrier pour planifier les r√©visions et les examens",
            category: "parents",
            type: "pdf",
            fileUrl: "#",
            thumbnailUrl: "",
            subject: "g√©n√©ral",
            gradeLevel: ["tous"],
            published: true,
            createdAt: firebase.firestore.Timestamp.now()
          }
        ];

        for (const resource of resources) {
          await db.collection('resources').add(resource);
        }
        progress.className = 'progress-item success';
        progress.textContent = `‚úÖ ${resources.length} ressources cr√©√©es avec succ√®s`;

        // Success
        successDiv.innerHTML = `
          <strong>‚úÖ Initialisation termin√©e avec succ√®s!</strong><br><br>
          Vos collections Firestore ont √©t√© cr√©√©es avec:<br>
          ‚Ä¢ 1 banni√®re d'exemple<br>
          ‚Ä¢ ${blogArticles.length} articles de blog<br>
          ‚Ä¢ ${resources.length} ressources<br><br>
          Vous pouvez maintenant:<br>
          1. Voir les donn√©es dans la <a href="https://console.firebase.google.com" target="_blank">Console Firebase</a><br>
          2. Modifier les donn√©es via <a href="add-data.html">le panneau admin</a><br>
          3. Tester votre site web
        `;
        successDiv.style.display = 'block';
        btn.textContent = '‚úÖ Initialisation r√©ussie';
        btn.style.background = '#28a745';

      } catch (error) {
        console.error('Error:', error);
        errorDiv.innerHTML = `<strong>‚ùå Erreur:</strong><br>${error.message}`;
        errorDiv.style.display = 'block';
        btn.disabled = false;
        btn.textContent = 'R√©essayer';
      }
    }
  </script>
</body>
</html>

